<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sistema Punto de Venta</title>
    <link rel="stylesheet" href="../css/stylePOS.css" />
  </head>

  <body>
    <div class="container">
      <header>
        <div class="header-content">
          <div class="logo">Sistema POS</div>
          <div class="user-info">
            <div class="user-avatar" id="userAvatar"></div>
            <div id="userName">Cajero: No asignado</div>
          </div>
        </div>
      </header>

      <div class="main-content">
        <div class="left-panel">
          <!-- Agregar producto -->
          <div class="card search-product-card">
            <h2 class="card-title">Agregar Producto</h2>
            <div class="form-group">
              <label for="productID">ID del Producto</label>
              <input
                type="text"
                id="productID"
                placeholder="Ingrese ID del producto"
              />
            </div>
            <div class="form-group search-container">
              <label for="productSearch">Buscar Producto</label>
              <input
                type="text"
                id="productSearch"
                placeholder="Buscar por nombre o c贸digo..."
              />
              <!-- Contenedor para resultados en tiempo real -->
              <div
                id="searchResults"
                class="search-results"
                style="display: none"
              ></div>
            </div>
            <div class="btn-group">
              <button class="btn btn-primary" id="addProductBtn">
                A帽adir Producto
              </button>
              <button class="btn btn-warning" id="searchProductBtn">
                Buscar
              </button>
            </div>
          </div>

          <!-- B煤squeda de cup贸n -->
          <div class="card">
            <h2 class="card-title">B煤squeda de Cup贸n</h2>
            <div class="form-group">
              <label for="searchCupon">Buscar cup贸n por c贸digo</label>
              <input
                type="text"
                id="searchCupon"
                placeholder="Ingrese c贸digo del cup贸n..."
                style="text-transform: uppercase"
              />
            </div>
            <button class="btn btn-primary" id="searchCuponBtn">
              Buscar Cup贸n
            </button>

            <!-- Informaci贸n del cup贸n seleccionado -->
            <div class="cupon-info" id="cuponInfo" style="display: none">
              <div class="cupon-details">
                <div class="cupon-header">
                  <span class="cupon-codigo" id="cuponCodigo"></span>
                  <span class="cupon-descuento" id="cuponDescuento"></span>
                </div>
                <div class="cupon-nombre" id="cuponNombre"></div>
                <div class="cupon-stats">
                  <span id="cuponUsos"></span>
                  <span id="cuponExpiracion"></span>
                </div>
              </div>
              <button class="btn btn-danger" id="removeCuponBtn">
                Quitar Cup贸n
              </button>
            </div>
          </div>

          <!-- B煤squeda de cliente (MOVIDA HACIA ABAJO) -->
          <div class="card">
            <h2 class="card-title">B煤squeda de Cliente</h2>
            <div class="form-group">
              <label for="searchCustomer"
                >Buscar cliente por nombre, tel茅fono o correo</label
              >
              <input
                type="text"
                id="searchCustomer"
                placeholder="Ingrese datos del cliente..."
              />
            </div>
            <button class="btn btn-primary" id="searchCustomerBtn">
              Buscar Cliente
            </button>

            <!-- Informaci贸n del cliente seleccionado -->
            <div class="customer-info" id="customerInfo" style="display: none">
              <div class="customer-avatar" id="customerAvatar"></div>
              <div class="customer-details">
                <div class="customer-name" id="customerName"></div>
                <div class="customer-contact" id="customerContact"></div>
              </div>
            </div>
          </div>

          <!-- Cierre de caja -->
          <div class="card cash-register-section">
            <h2 class="card-title">Cierre de Caja</h2>
            <p>Realice el cierre de caja al final del turno</p>
            <div class="register-stats">
              <div class="stat-card">
                <div class="stat-label">Ventas del D铆a</div>
                <div class="stat-value" id="dailySales">$0.00</div>
              </div>
              <div class="stat-card">
                <div class="stat-label">Transacciones</div>
                <div class="stat-value" id="transactionsCount">0</div>
              </div>
              <div class="stat-card">
                <div class="stat-label">Ticket Promedio</div>
                <div class="stat-value" id="averageTicket">$0.00</div>
              </div>
            </div>
            <div class="actions-section">
              <button class="btn btn-warning" id="dailyReportBtn">
                Reporte Diario
              </button>
              <button class="btn btn-secondary" id="returnBtn" style="background: #8e44ad; color: white;">
                <i class="fas fa-undo"></i> Devoluci贸n
              </button>
              <button class="btn btn-danger" id="closeRegisterBtn">
                Cierre de Caja
              </button>
            </div>
          </div>
        </div>

        <div class="right-panel">
          <!-- Carrito de compras -->
          <div class="card">
            <h2 class="card-title">Carrito de Compras</h2>

            <!-- Tabla de productos -->
            <table id="cartTable">
              <thead>
                <tr>
                  <th>Producto</th>
                  <th>Cantidad</th>
                  <th>Precio Unit.</th>
                  <th>Subtotal</th>
                  <th>Acciones</th>
                </tr>
              </thead>
              <tbody id="cartBody">
                <!-- El carrito estar谩 vac铆o inicialmente -->
              </tbody>
            </table>

            <!-- Mensaje cuando el carrito est谩 vac铆o -->
            <div class="empty-cart" id="emptyCartMessage">
              <i></i>
              <p>El carrito est谩 vac铆o</p>
              <p>Agregue productos para comenzar una venta</p>
            </div>

            <!-- Resumen de venta -->
            <div class="sale-summary">
              <div class="summary-row">
                <span>Subtotal:</span>
                <span id="subtotalAmount">$0.00</span>
              </div>
              <div class="summary-row" id="descuentoRow" style="display: none">
                <span>Descuento:</span>
                <span id="descuentoAmount">-$0.00</span>
              </div>
              <div class="summary-row total">
                <span>Total:</span>
                <span id="totalAmount">$0.00</span>
              </div>
            </div>

            <div class="actions-section">
              <button class="btn btn-danger" id="removeProductBtn">
                Eliminar Producto
              </button>
              <button class="btn btn-primary" id="addAnotherProductBtn">
                A帽adir Producto
              </button>
              <button class="btn btn-success" id="checkoutBtn">Cobrar</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="return-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Procesar Devoluci贸n</h3>
          <span class="close">&times;</span>
        </div>
        <div class="modal-body">
          <div id="return-step-1">
            <div class="form-group">
              <label>ID de Venta / Ticket:</label>
              <div style="display: flex; gap: 10px;">
                <input type="text" id="returnSaleId" placeholder="Ej: 654a..." style="flex:1;">
                <button class="btn btn-primary" id="searchSaleBtn">Buscar</button>
              </div>
            </div>
          </div>

          <div id="return-step-2" style="display: none; margin-top: 20px;">
            <h4>Seleccione productos a devolver:</h4>
            <table class="products-table" style="font-size: 0.9em;">
              <thead>
                <tr>
                  <th>Producto</th>
                  <th>Cant. Orig.</th>
                  <th>A Devolver</th>
                </tr>
              </thead>
              <tbody id="returnItemsTable"></tbody>
            </table>
            <div style="margin-top: 20px; text-align: right;">
              <h3>Total a Reembolsar: <span id="refundTotalDisplay">$0.00</span></h3>
            </div>
            <button class="btn btn-danger" id="confirmReturnBtn" style="width: 100%; margin-top: 15px;">
              Confirmar Devoluci贸n
            </button>
          </div>
        </div>
      </div>
    </div>
    <script src="../js/pos.js"></script>
  </body>
</html>
